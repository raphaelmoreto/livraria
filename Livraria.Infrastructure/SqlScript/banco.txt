CREATE DATABASE Livraria;

USE Livraria;

CREATE TABLE Categoria (
	id INT PRIMARY KEY IDENTITY(1,1),
	nome VARCHAR(255) NOT NULL
);

INSERT INTO [Categoria] ([nome])
				 VALUES ('AVENTURA'),
						('CLÁSSICOS'),
						('CONTOS'),
						('CRÔNICAS'),
						('DISTOPIA'),
						('DRAMA'),
						('FANTASIA'),
						('FICÇÃO'),
						('FICÇÃO CIENTÍFICA'),
						('LITERATURA INFANTIL'),
						('MISTÉRIO'),
						('POESIA'),
						('ROMANCE'),
						('ROMANCE HISTÓRICO'),
						('SUSPENSE'),
						('TERROR');

CREATE TABLE Autor (
	id INT PRIMARY KEY IDENTITY(1,1),
	nome VARCHAR(255) NOT NULL
);

INSERT INTO [Autor] ([nome])
				 VALUES ('AGATHA MARY CLARISSA CHRISTIE'),
						('ALBERT CAMUS'),
						('ALDOUS LEONARD HUXLEY'),
						('ANTON PAVLOVICH CHEKHOV'),
						('ARTHUR IGNATIUS CONAN DOYLE'),
						('CHARLES JOHN HUFFAM DICKENS'),
						('DANTE ALIGHIERI'),
						('EDGAR ALLAN POE'),
						('EMILY JANE BRONTË'),
						('ERNEST MILLER HEMINGWAY'),
						('FÉDOR MIQUAILOVITCH DOSTOIÉVSKI'),
						('FRANZ KAFKA'),
						('GABRIEL JOSÉ DE LA CONCORDIA GARCÍA MÁRQUEZ'),
						('GEORGE ORWELL (ERIC ARTHUR BLAIR)'),
						('HERBERT GEORGE WELLS'),
						('HOMERO'),
						('JOANNE KATHLEEN ROWLING'),
						('JOHN RONALD REUEL TOLKIEN'),
						('JANE AUSTEN'),
						('JOÃO GUIMARÃES ROSA (JOÃO ROSA)'),
						('JOSÉ DE SOUSA SARAMAGO'),
						('JULES GABRIEL VERNE'),
						('CHARLES LUTWIDGE DODGSON (LEWIS CARROLL)'),
						('JOAQUIM MARIA MACHADO DE ASSIS'),
						('SAMUEL LANGHORNE CLEMENS (MARK TWAIN)'),
						('MARY WOLLSTONECRAFT SHELLEY'),
						('MIGUEL DE CERVANTES SAAVEDRA'),
						('OSCAR FINGAL O’FLAHERTIE WILLS WILDE'),
						('LEÓN NIKOLÁIEVITCH TOLSTÓI'),
						('VICTOR MARIE HUGO'),
						('WILLIAM SHAKESPEARE');

CREATE TABLE Livro (
	id INT PRIMARY KEY IDENTITY(1,1),
	titulo VARCHAR(255) NOT NULL,
	subtitulo VARCHAR(255) DEFAULT '',
	isbn VARCHAR(15) NOT NULL, --Número Internacional Padronizado de Livro
	dt_publicacao DATETIME NOT NULL,
	codigo_barras VARCHAR(50) NOT NULL,
	preco DECIMAL(18,2) NOT NULL,
	qt_estoque INT NOT NULL DEFAULT 0,
	fk_autor INT,
	fk_categoria INT
);

ALTER TABLE Livro
ADD CONSTRAINT fk_livro_autor
FOREIGN KEY (fk_autor) REFERENCES Autor (id);

ALTER TABLE Livro
ADD CONSTRAINT fk_livro_categoria
FOREIGN KEY (fk_categoria) REFERENCES Categoria (id);

CREATE TABLE Movimentacao (
	id INT PRIMARY KEY IDENTITY(1,1),
	tipo VARCHAR(20) NOT NULL, --ENTRADA OU SAÍDA
	dt_movimentacao DATETIME NOT NULL, --Quando o livro foi cadastrado no sistema
	quantidade INT NOT NULL,
	fk_livro INT NOT NULL
);

ALTER TABLE Movimentacao
ADD CONSTRAINT fk_movimentacao_livro
FOREIGN KEY (fk_livro) REFERENCES Livro (id);